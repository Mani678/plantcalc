<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PlantCalc ‚Äî Industrial Process Calculator</title>
<link rel="manifest" href="./manifest.json">
<meta name="theme-color" content="#00c9a7">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="PlantCalc">
<link rel="apple-touch-icon" href="./icon-192.svg">
<meta name="description" content="Professional instrumentation calculator for Pressure, Level, Flow and Temperature. For field technicians and process engineers.">
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Barlow:wght@300;400;600;700&family=Barlow+Condensed:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0d0f;
    --surface: #111518;
    --panel: #161b1f;
    --border: #1e2a30;
    --border-bright: #2a3a44;
    --accent: #00c9a7;
    --accent2: #0099ff;
    --accent3: #ff9500;
    --accent4: #ff4757;
    --text: #c8d8e0;
    --text-dim: #5a7080;
    --text-bright: #eaf4f8;
    --mono: 'Share Tech Mono', monospace;
    --sans: 'Barlow', sans-serif;
    --cond: 'Barlow Condensed', sans-serif;
    --glow: 0 0 20px rgba(0,201,167,0.15);
    --glow2: 0 0 20px rgba(0,153,255,0.15);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--sans);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Grid background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(0,201,167,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,201,167,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    position: relative;
    z-index: 10;
    background: linear-gradient(180deg, #0d1418 0%, transparent 100%);
    border-bottom: 1px solid var(--border);
    padding: 0 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 64px;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .logo-icon {
    width: 36px;
    height: 36px;
    border: 2px solid var(--accent);
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: var(--glow), inset 0 0 10px rgba(0,201,167,0.1);
    animation: pulse 3s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { box-shadow: var(--glow), inset 0 0 10px rgba(0,201,167,0.1); }
    50% { box-shadow: 0 0 30px rgba(0,201,167,0.3), inset 0 0 15px rgba(0,201,167,0.2); }
  }

  .logo-icon svg { width: 20px; height: 20px; stroke: var(--accent); fill: none; stroke-width: 2; }

  .logo-text {
    font-family: var(--cond);
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-bright);
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  .logo-text span { color: var(--accent); }

  .header-meta {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--text-dim);
    text-align: right;
    line-height: 1.6;
  }

  .status-dot {
    display: inline-block;
    width: 6px; height: 6px;
    background: var(--accent);
    border-radius: 50%;
    margin-right: 6px;
    animation: blink 2s step-end infinite;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.2; }
  }

  /* ‚îÄ‚îÄ TABS ‚îÄ‚îÄ */
  .tab-bar {
    position: relative;
    z-index: 10;
    display: flex;
    gap: 0;
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 0 2rem;
    overflow-x: auto;
    scrollbar-width: none;
  }

  .tab-bar::-webkit-scrollbar { display: none; }

  .tab {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 0 1.5rem;
    height: 52px;
    font-family: var(--cond);
    font-size: 0.85rem;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--text-dim);
    cursor: pointer;
    border: none;
    background: transparent;
    border-bottom: 2px solid transparent;
    white-space: nowrap;
    transition: color 0.2s, border-color 0.2s;
    position: relative;
  }

  .tab:hover { color: var(--text); }

  .tab.active { color: var(--text-bright); border-bottom-color: var(--tab-color, var(--accent)); }

  .tab[data-tab="pressure"] { --tab-color: #0099ff; }
  .tab[data-tab="level"]    { --tab-color: #00c9a7; }
  .tab[data-tab="flow"]     { --tab-color: #ff9500; }
  .tab[data-tab="temperature"] { --tab-color: #ff4757; }

  .tab-icon { font-size: 1.1rem; }

  /* ‚îÄ‚îÄ MAIN LAYOUT ‚îÄ‚îÄ */
  .app-body {
    position: relative;
    z-index: 5;
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  .tab-content { display: none; }
  .tab-content.active { display: block; animation: fadeIn 0.3s ease; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* ‚îÄ‚îÄ SECTION HEADER ‚îÄ‚îÄ */
  .section-header {
    margin-bottom: 2rem;
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .section-title {
    font-family: var(--cond);
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-bright);
    letter-spacing: 0.05em;
    text-transform: uppercase;
    line-height: 1;
  }

  .section-title span {
    display: block;
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--text-dim);
    font-weight: 400;
    letter-spacing: 0.15em;
    margin-bottom: 4px;
  }

  .section-accent {
    height: 3px;
    width: 60px;
    border-radius: 2px;
    margin-top: 8px;
  }

  .tag {
    font-family: var(--mono);
    font-size: 0.65rem;
    color: var(--text-dim);
    border: 1px solid var(--border);
    padding: 4px 10px;
    border-radius: 3px;
    letter-spacing: 0.1em;
  }

  /* ‚îÄ‚îÄ CALCULATOR GRID ‚îÄ‚îÄ */
  .calc-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
  }

  @media (max-width: 768px) {
    .calc-grid { grid-template-columns: 1fr; }
    .app-body { padding: 1rem; }
    header { padding: 0 1rem; }
    .tab-bar { padding: 0 1rem; }
  }

  /* ‚îÄ‚îÄ CALC CARD ‚îÄ‚îÄ */
  .calc-card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
    transition: border-color 0.2s;
  }

  .calc-card:hover { border-color: var(--border-bright); }

  .card-header {
    padding: 1rem 1.25rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(90deg, rgba(255,255,255,0.02) 0%, transparent 100%);
  }

  .card-title {
    font-family: var(--cond);
    font-size: 0.85rem;
    font-weight: 600;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--text-bright);
  }

  .card-badge {
    font-family: var(--mono);
    font-size: 0.6rem;
    padding: 2px 8px;
    border-radius: 2px;
    letter-spacing: 0.1em;
  }

  .card-body { padding: 1.25rem; }

  /* ‚îÄ‚îÄ FORM ELEMENTS ‚îÄ‚îÄ */
  .field-group { margin-bottom: 1rem; }

  label {
    display: block;
    font-family: var(--mono);
    font-size: 0.65rem;
    color: var(--text-dim);
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-bottom: 6px;
  }

  .input-row {
    display: flex;
    gap: 8px;
  }

  input[type="number"], select {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 4px;
    color: var(--text-bright);
    font-family: var(--mono);
    font-size: 0.9rem;
    padding: 8px 12px;
    width: 100%;
    transition: border-color 0.2s, box-shadow 0.2s;
    -moz-appearance: textfield;
  }

  input[type="number"]::-webkit-inner-spin-button { display: none; }

  input[type="number"]:focus, select:focus {
    outline: none;
    border-color: var(--focus-color, var(--accent));
    box-shadow: 0 0 0 2px rgba(0,201,167,0.1);
  }

  select {
    flex-shrink: 0;
    width: auto;
    min-width: 80px;
    cursor: pointer;
  }

  select option { background: var(--surface); }

  .calc-btn {
    width: 100%;
    margin-top: 1.25rem;
    padding: 12px;
    font-family: var(--cond);
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: opacity 0.2s, transform 0.1s, box-shadow 0.2s;
  }

  .calc-btn:hover { opacity: 0.9; transform: translateY(-1px); }
  .calc-btn:active { transform: translateY(0); }

  /* ‚îÄ‚îÄ RESULTS ‚îÄ‚îÄ */
  .result-panel {
    margin-top: 1.25rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 1rem;
    display: none;
  }

  .result-panel.show { display: block; animation: fadeIn 0.3s ease; }

  .result-label {
    font-family: var(--mono);
    font-size: 0.6rem;
    color: var(--text-dim);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 4px;
  }

  .result-value {
    font-family: var(--mono);
    font-size: 1.4rem;
    font-weight: 400;
    color: var(--text-bright);
    line-height: 1.2;
  }

  .result-value span { font-size: 0.8rem; color: var(--text-dim); margin-left: 6px; }

  .result-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.75rem;
  }

  .result-item {
    padding: 0.75rem;
    background: var(--panel);
    border-radius: 4px;
    border: 1px solid var(--border);
  }

  .formula-box {
    margin-top: 0.75rem;
    padding: 0.6rem 0.75rem;
    background: rgba(0,0,0,0.3);
    border-left: 2px solid var(--border-bright);
    border-radius: 0 4px 4px 0;
    font-family: var(--mono);
    font-size: 0.65rem;
    color: var(--text-dim);
    letter-spacing: 0.05em;
  }

  /* ‚îÄ‚îÄ DIVIDER ‚îÄ‚îÄ */
  .divider {
    margin: 1.5rem 0;
    border: none;
    border-top: 1px solid var(--border);
    position: relative;
  }

  /* ‚îÄ‚îÄ COLOR THEMES PER TAB ‚îÄ‚îÄ */
  #pressure .section-accent { background: var(--accent2); }
  #pressure input:focus, #pressure select:focus { --focus-color: var(--accent2); box-shadow: 0 0 0 2px rgba(0,153,255,0.1); }
  #pressure .calc-btn { background: var(--accent2); color: #000; box-shadow: 0 4px 15px rgba(0,153,255,0.2); }
  #pressure .result-value { color: var(--accent2); }
  #pressure .card-badge { background: rgba(0,153,255,0.1); color: var(--accent2); border: 1px solid rgba(0,153,255,0.2); }

  #level .section-accent { background: var(--accent); }
  #level input:focus, #level select:focus { --focus-color: var(--accent); box-shadow: 0 0 0 2px rgba(0,201,167,0.1); }
  #level .calc-btn { background: var(--accent); color: #000; box-shadow: 0 4px 15px rgba(0,201,167,0.2); }
  #level .result-value { color: var(--accent); }
  #level .card-badge { background: rgba(0,201,167,0.1); color: var(--accent); border: 1px solid rgba(0,201,167,0.2); }

  #flow .section-accent { background: var(--accent3); }
  #flow input:focus, #flow select:focus { --focus-color: var(--accent3); box-shadow: 0 0 0 2px rgba(255,149,0,0.1); }
  #flow .calc-btn { background: var(--accent3); color: #000; box-shadow: 0 4px 15px rgba(255,149,0,0.2); }
  #flow .result-value { color: var(--accent3); }
  #flow .card-badge { background: rgba(255,149,0,0.1); color: var(--accent3); border: 1px solid rgba(255,149,0,0.2); }

  #temperature .section-accent { background: var(--accent4); }
  #temperature input:focus, #temperature select:focus { --focus-color: var(--accent4); box-shadow: 0 0 0 2px rgba(255,71,87,0.1); }
  #temperature .calc-btn { background: var(--accent4); color: #fff; box-shadow: 0 4px 15px rgba(255,71,87,0.2); }
  #temperature .result-value { color: var(--accent4); }
  #temperature .card-badge { background: rgba(255,71,87,0.1); color: var(--accent4); border: 1px solid rgba(255,71,87,0.2); }

  /* ‚îÄ‚îÄ INFO STRIP ‚îÄ‚îÄ */
  .info-strip {
    margin-top: 1.5rem;
    padding: 0.75rem 1rem;
    background: rgba(255,255,255,0.02);
    border: 1px solid var(--border);
    border-radius: 4px;
    font-family: var(--mono);
    font-size: 0.65rem;
    color: var(--text-dim);
    line-height: 1.8;
    letter-spacing: 0.05em;
  }

  .info-strip strong { color: var(--text); font-weight: 400; }

  /* ‚îÄ‚îÄ FULL WIDTH CARD ‚îÄ‚îÄ */
  .calc-card.full { grid-column: 1 / -1; }

  /* ‚îÄ‚îÄ LRV/URV DISPLAY ‚îÄ‚îÄ */
  .range-bar-wrap { margin-top: 0.75rem; }
  .range-bar-track {
    height: 8px;
    background: var(--surface);
    border-radius: 4px;
    border: 1px solid var(--border);
    overflow: hidden;
    position: relative;
  }
  .range-bar-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.5s ease;
  }
  .range-labels {
    display: flex;
    justify-content: space-between;
    font-family: var(--mono);
    font-size: 0.6rem;
    color: var(--text-dim);
    margin-top: 4px;
  }

  /* ‚îÄ‚îÄ PWA INSTALL BANNER ‚îÄ‚îÄ */
  #install-banner {
    display: none;
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    z-index: 1000;
    background: var(--panel);
    border: 1px solid var(--accent);
    border-radius: 8px;
    padding: 1rem 1.25rem;
    box-shadow: 0 8px 32px rgba(0,0,0,0.5), var(--glow);
    max-width: 300px;
    animation: slideUp 0.4s ease;
  }
  @keyframes slideUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  #install-banner.show { display: block; }
  .install-title { font-family: var(--cond); font-size: 0.85rem; font-weight: 700; color: var(--accent); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 4px; }
  .install-desc { font-family: var(--mono); font-size: 0.65rem; color: var(--text-dim); line-height: 1.6; margin-bottom: 0.75rem; }
  .install-actions { display: flex; gap: 8px; }
  .install-btn { flex: 1; padding: 8px; font-family: var(--cond); font-size: 0.75rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; border: none; border-radius: 4px; cursor: pointer; }
  .install-btn.primary { background: var(--accent); color: #000; }
  .install-btn.secondary { background: transparent; border: 1px solid var(--border); color: var(--text-dim); }

  /* ‚îÄ‚îÄ OFFLINE / ONLINE INDICATORS ‚îÄ‚îÄ */
  #offline-bar { display: none; position: fixed; top: 0; left: 0; right: 0; z-index: 2000; background: #ff4757; color: #fff; font-family: var(--mono); font-size: 0.65rem; letter-spacing: 0.1em; text-align: center; padding: 6px; text-transform: uppercase; }
  #offline-bar.show { display: block; }
  #online-flash { display: none; position: fixed; top: 0; left: 0; right: 0; z-index: 2000; background: var(--accent); color: #000; font-family: var(--mono); font-size: 0.65rem; letter-spacing: 0.1em; text-align: center; padding: 6px; text-transform: uppercase; }

  /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
  footer {
    position: relative;
    z-index: 5;
    border-top: 1px solid var(--border);
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 3rem;
  }

  footer p {
    font-family: var(--mono);
    font-size: 0.62rem;
    color: var(--text-dim);
    letter-spacing: 0.08em;
  }
</style>
</head>
<body>

<header>
  <div class="logo">
    <div class="logo-icon">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2v3M12 19v3M2 12h3M19 12h3M5.64 5.64l2.12 2.12M16.24 16.24l2.12 2.12M5.64 18.36l2.12-2.12M16.24 7.76l2.12-2.12"/></svg>
    </div>
    <div class="logo-text">Plant<span>Calc</span></div>
  </div>
  <div class="header-meta">
    <span class="status-dot"></span>SYSTEM ONLINE<br>
    PROCESS INSTRUMENTATION SUITE v1.0
  </div>
</header>

<div class="tab-bar">
  <button class="tab active" data-tab="pressure" onclick="switchTab('pressure')">
    <span class="tab-icon">‚¨°</span> Pressure
  </button>
  <button class="tab" data-tab="level" onclick="switchTab('level')">
    <span class="tab-icon">‚óà</span> Level
  </button>
  <button class="tab" data-tab="flow" onclick="switchTab('flow')">
    <span class="tab-icon">‚Üù</span> Flow
  </button>
  <button class="tab" data-tab="temperature" onclick="switchTab('temperature')">
    <span class="tab-icon">‚¨°</span> Temperature
  </button>
</div>

<div class="app-body">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PRESSURE ‚ïê‚ïê‚ïê -->
  <div id="pressure" class="tab-content active">
    <div class="section-header">
      <div>
        <div class="section-title"><span>MODULE 01</span>Pressure</div>
        <div class="section-accent"></div>
      </div>
      <div class="tag">HYDROSTATIC ¬∑ UNIT CONVERSION ¬∑ DP</div>
    </div>

    <div class="calc-grid">

      <!-- Hydrostatic Pressure -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Hydrostatic Pressure</div>
          <div class="card-badge">P = œÅgh</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Fluid Density</label>
            <div class="input-row">
              <input type="number" id="p_density" placeholder="1000" step="any">
              <select id="p_density_unit">
                <option value="kgm3">kg/m¬≥</option>
                <option value="lbft3">lb/ft¬≥</option>
                <option value="sgrav">SG</option>
              </select>
            </div>
          </div>
          <div class="field-group">
            <label>Fluid Column Height</label>
            <div class="input-row">
              <input type="number" id="p_height" placeholder="5.0" step="any">
              <select id="p_height_unit">
                <option value="m">m</option>
                <option value="ft">ft</option>
                <option value="in">in</option>
                <option value="mm">mm</option>
              </select>
            </div>
          </div>
          <button class="calc-btn" onclick="calcHydrostatic()">CALCULATE</button>
          <div class="result-panel" id="p_result">
            <div class="result-grid">
              <div class="result-item">
                <div class="result-label">Pascals</div>
                <div class="result-value" id="p_pa">‚Äî<span>Pa</span></div>
              </div>
              <div class="result-item">
                <div class="result-label">Bar</div>
                <div class="result-value" id="p_bar">‚Äî<span>bar</span></div>
              </div>
              <div class="result-item">
                <div class="result-label">PSI</div>
                <div class="result-value" id="p_psi">‚Äî<span>psi</span></div>
              </div>
              <div class="result-item">
                <div class="result-label">kPa</div>
                <div class="result-value" id="p_kpa">‚Äî<span>kPa</span></div>
              </div>
            </div>
            <div class="formula-box" id="p_formula"></div>
          </div>
        </div>
      </div>

      <!-- Pressure Unit Converter -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Unit Converter</div>
          <div class="card-badge">MULTI-UNIT</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Input Pressure</label>
            <div class="input-row">
              <input type="number" id="pu_value" placeholder="100" step="any">
              <select id="pu_from">
                <option value="pa">Pa</option>
                <option value="kpa">kPa</option>
                <option value="bar" selected>bar</option>
                <option value="mbar">mbar</option>
                <option value="psi">psi</option>
                <option value="atm">atm</option>
                <option value="mmhg">mmHg</option>
                <option value="inwc">inH‚ÇÇO</option>
                <option value="mmwc">mmH‚ÇÇO</option>
              </select>
            </div>
          </div>
          <button class="calc-btn" onclick="calcPressureConvert()">CONVERT ALL UNITS</button>
          <div class="result-panel" id="pu_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">Pa</div><div class="result-value" id="pu_pa">‚Äî</div></div>
              <div class="result-item"><div class="result-label">kPa</div><div class="result-value" id="pu_kpa">‚Äî</div></div>
              <div class="result-item"><div class="result-label">bar</div><div class="result-value" id="pu_bar">‚Äî</div></div>
              <div class="result-item"><div class="result-label">mbar</div><div class="result-value" id="pu_mbar">‚Äî</div></div>
              <div class="result-item"><div class="result-label">PSI</div><div class="result-value" id="pu_psi">‚Äî</div></div>
              <div class="result-item"><div class="result-label">atm</div><div class="result-value" id="pu_atm">‚Äî</div></div>
              <div class="result-item"><div class="result-label">mmHg</div><div class="result-value" id="pu_mmhg">‚Äî</div></div>
              <div class="result-item"><div class="result-label">inH‚ÇÇO</div><div class="result-value" id="pu_inwc">‚Äî</div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Transmitter LRV/URV Scaling -->
      <div class="calc-card full">
        <div class="card-header">
          <div class="card-title">Transmitter Scaling ‚Äî LRV / URV / 4‚Äì20 mA</div>
          <div class="card-badge">SPAN CALC</div>
        </div>
        <div class="card-body">
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem">
            <div class="field-group">
              <label>LRV (Lower Range Value)</label>
              <div class="input-row"><input type="number" id="p_lrv" placeholder="0" step="any"><select id="p_lrv_unit"><option>bar</option><option>psi</option><option>kPa</option></select></div>
            </div>
            <div class="field-group">
              <label>URV (Upper Range Value)</label>
              <div class="input-row"><input type="number" id="p_urv" placeholder="10" step="any"><select id="p_urv_unit"><option>bar</option><option>psi</option><option>kPa</option></select></div>
            </div>
            <div class="field-group">
              <label>Process Value (PV)</label>
              <div class="input-row"><input type="number" id="p_pv" placeholder="5" step="any"></div>
            </div>
          </div>
          <button class="calc-btn" onclick="calcPressureScaling()" style="max-width:300px">CALCULATE mA OUTPUT</button>
          <div class="result-panel" id="p_scale_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">mA Output</div><div class="result-value" id="p_ma">‚Äî<span>mA</span></div></div>
              <div class="result-item"><div class="result-label">% of Span</div><div class="result-value" id="p_pct">‚Äî<span>%</span></div></div>
              <div class="result-item"><div class="result-label">Span</div><div class="result-value" id="p_span">‚Äî</div></div>
              <div class="result-item"><div class="result-label">Signal Range</div><div class="result-value" id="p_sigrange" style="font-size:0.9rem">4‚Äì20 mA</div></div>
            </div>
            <div class="range-bar-wrap">
              <div class="result-label" style="margin-top:0.75rem;margin-bottom:4px">SIGNAL POSITION</div>
              <div class="range-bar-track"><div class="range-bar-fill" id="p_bar_fill" style="background:var(--accent2);width:0%"></div></div>
              <div class="range-labels"><span>4 mA (LRV)</span><span>12 mA (50%)</span><span>20 mA (URV)</span></div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="info-strip">
      <strong>REFERENCE:</strong> &nbsp;1 bar = 100,000 Pa &nbsp;|&nbsp; 1 psi = 6894.76 Pa &nbsp;|&nbsp; 1 atm = 101,325 Pa &nbsp;|&nbsp; g = 9.81 m/s¬≤ &nbsp;|&nbsp; Water density (20¬∞C) = 998 kg/m¬≥
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LEVEL ‚ïê‚ïê‚ïê -->
  <div id="level" class="tab-content">
    <div class="section-header">
      <div>
        <div class="section-title"><span>MODULE 02</span>Level</div>
        <div class="section-accent"></div>
      </div>
      <div class="tag">DRY LEG ¬∑ WET LEG ¬∑ DP RANGING</div>
    </div>

    <div class="calc-grid">

      <!-- Dry Leg -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Dry Leg DP Level</div>
          <div class="card-badge">OPEN TOP</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Process Fluid Density (kg/m¬≥)</label>
            <input type="number" id="dl_density" placeholder="850" step="any">
          </div>
          <div class="field-group">
            <label>Vessel Height (H) ‚Äî m</label>
            <input type="number" id="dl_height" placeholder="3.0" step="any">
          </div>
          <div class="field-group">
            <label>Low Tap Elevation from Datum (m)</label>
            <input type="number" id="dl_low" placeholder="0" step="any">
          </div>
          <button class="calc-btn" onclick="calcDryLeg()">CALCULATE DP</button>
          <div class="result-panel" id="dl_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">DP at 0% (LRV)</div><div class="result-value" id="dl_lrv">‚Äî<span>Pa</span></div></div>
              <div class="result-item"><div class="result-label">DP at 100% (URV)</div><div class="result-value" id="dl_urv">‚Äî<span>Pa</span></div></div>
              <div class="result-item"><div class="result-label">LRV (mbar)</div><div class="result-value" id="dl_lrv_mbar">‚Äî<span>mbar</span></div></div>
              <div class="result-item"><div class="result-label">URV (mbar)</div><div class="result-value" id="dl_urv_mbar">‚Äî<span>mbar</span></div></div>
            </div>
            <div class="formula-box">Dry Leg: DP = œÅ_process √ó g √ó h &nbsp;|&nbsp; LRV = 0 Pa (empty) &nbsp;|&nbsp; URV = œÅ √ó g √ó H</div>
          </div>
        </div>
      </div>

      <!-- Wet Leg -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Wet Leg DP Level</div>
          <div class="card-badge">CLOSED/PRESSURISED</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Process Fluid Density (kg/m¬≥)</label>
            <input type="number" id="wl_proc_density" placeholder="850" step="any">
          </div>
          <div class="field-group">
            <label>Wet Leg Fluid Density (kg/m¬≥)</label>
            <input type="number" id="wl_leg_density" placeholder="998" step="any">
          </div>
          <div class="field-group">
            <label>Vessel Height H (m)</label>
            <input type="number" id="wl_height" placeholder="3.0" step="any">
          </div>
          <div class="field-group">
            <label>Wet Leg Height L (m)</label>
            <input type="number" id="wl_leg_height" placeholder="3.5" step="any">
          </div>
          <button class="calc-btn" onclick="calcWetLeg()">CALCULATE DP</button>
          <div class="result-panel" id="wl_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">LRV (vessel empty)</div><div class="result-value" id="wl_lrv">‚Äî<span>Pa</span></div></div>
              <div class="result-item"><div class="result-label">URV (vessel full)</div><div class="result-value" id="wl_urv">‚Äî<span>Pa</span></div></div>
              <div class="result-item"><div class="result-label">LRV (mbar)</div><div class="result-value" id="wl_lrv_mbar">‚Äî</div></div>
              <div class="result-item"><div class="result-label">URV (mbar)</div><div class="result-value" id="wl_urv_mbar">‚Äî</div></div>
            </div>
            <div class="formula-box">LRV = ‚àíœÅ_leg√óg√óL &nbsp;|&nbsp; URV = œÅ_proc√óg√óH ‚àí œÅ_leg√óg√óL &nbsp;(negative = suppressed zero)</div>
          </div>
        </div>
      </div>

      <!-- Level from DP + mA -->
      <div class="calc-card full">
        <div class="card-header">
          <div class="card-title">Live Level from mA Signal + Transmitter Range</div>
          <div class="card-badge">4‚Äì20 mA ‚Üí %LEVEL</div>
        </div>
        <div class="card-body">
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1rem">
            <div class="field-group">
              <label>4 mA Value (LRV)</label>
              <input type="number" id="lv_lrv" placeholder="-300" step="any">
            </div>
            <div class="field-group">
              <label>20 mA Value (URV)</label>
              <input type="number" id="lv_urv" placeholder="800" step="any">
            </div>
            <div class="field-group">
              <label>Actual mA Signal</label>
              <input type="number" id="lv_ma" placeholder="12" step="any" min="4" max="20">
            </div>
            <div class="field-group">
              <label>Vessel Height (m)</label>
              <input type="number" id="lv_height" placeholder="3" step="any">
            </div>
          </div>
          <button class="calc-btn" style="max-width:280px" onclick="calcLevelFromMA()">CALCULATE LIVE LEVEL</button>
          <div class="result-panel" id="lv_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">% Level</div><div class="result-value" id="lv_pct">‚Äî<span>%</span></div></div>
              <div class="result-item"><div class="result-label">Level Height</div><div class="result-value" id="lv_m">‚Äî<span>m</span></div></div>
              <div class="result-item"><div class="result-label">DP Value</div><div class="result-value" id="lv_dp">‚Äî<span>Pa</span></div></div>
              <div class="result-item"><div class="result-label">Span</div><div class="result-value" id="lv_span">‚Äî</div></div>
            </div>
            <div class="range-bar-wrap">
              <div class="result-label" style="margin-top:0.75rem;margin-bottom:4px">LEVEL INDICATOR</div>
              <div class="range-bar-track"><div class="range-bar-fill" id="lv_bar_fill" style="background:var(--accent);width:0%"></div></div>
              <div class="range-labels"><span>0% (Empty)</span><span>50%</span><span>100% (Full)</span></div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="info-strip">
      <strong>TIP:</strong> For suppressed zero (wet leg), LRV will be negative. Ensure transmitter supports negative ranging. &nbsp;|&nbsp; Wet leg fluid is typically the process condensate or a fill fluid (glycol, silicone oil).
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FLOW ‚ïê‚ïê‚ïê -->
  <div id="flow" class="tab-content">
    <div class="section-header">
      <div>
        <div class="section-title"><span>MODULE 03</span>Flow</div>
        <div class="section-accent"></div>
      </div>
      <div class="tag">ORIFICE ¬∑ DP FLOW ¬∑ VOLUMETRIC ¬∑ MASS</div>
    </div>

    <div class="calc-grid">

      <!-- DP Flow (Orifice Plate) -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Orifice Plate / DP Flow</div>
          <div class="card-badge">Q ‚àù ‚àöŒîP</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Max DP at Full Flow (Pa)</label>
            <input type="number" id="fp_dp_max" placeholder="25000" step="any">
          </div>
          <div class="field-group">
            <label>Max Flow Rate (Qmax)</label>
            <div class="input-row">
              <input type="number" id="fp_qmax" placeholder="500" step="any">
              <select id="fp_qunit">
                <option value="m3h">m¬≥/h</option>
                <option value="lpm">L/min</option>
                <option value="gpm">GPM</option>
                <option value="bbd">BBL/d</option>
              </select>
            </div>
          </div>
          <div class="field-group">
            <label>Actual DP Measured (Pa)</label>
            <input type="number" id="fp_dp_actual" placeholder="15000" step="any">
          </div>
          <button class="calc-btn" onclick="calcDPFlow()">CALCULATE FLOW</button>
          <div class="result-panel" id="fp_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">Actual Flow</div><div class="result-value" id="fp_q">‚Äî</div></div>
              <div class="result-item"><div class="result-label">% of Max Flow</div><div class="result-value" id="fp_pct">‚Äî<span>%</span></div></div>
            </div>
            <div class="formula-box">Q_actual = Q_max √ó ‚àö(DP_actual / DP_max) &nbsp;|&nbsp; Square root extraction applies</div>
          </div>
        </div>
      </div>

      <!-- Volumetric ‚Üí Mass Flow -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Volumetric ‚Üí Mass Flow</div>
          <div class="card-badge">·πÅ = œÅQ</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Volumetric Flow Rate</label>
            <div class="input-row">
              <input type="number" id="mf_vol" placeholder="100" step="any">
              <select id="mf_vunit">
                <option value="m3h">m¬≥/h</option>
                <option value="lpm">L/min</option>
                <option value="gpm">GPM</option>
              </select>
            </div>
          </div>
          <div class="field-group">
            <label>Fluid Density (kg/m¬≥)</label>
            <input type="number" id="mf_density" placeholder="850" step="any">
          </div>
          <button class="calc-btn" onclick="calcMassFlow()">CALCULATE</button>
          <div class="result-panel" id="mf_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">Mass Flow</div><div class="result-value" id="mf_kgh">‚Äî<span>kg/h</span></div></div>
              <div class="result-item"><div class="result-label">Mass Flow</div><div class="result-value" id="mf_kgs">‚Äî<span>kg/s</span></div></div>
              <div class="result-item"><div class="result-label">Tonnes/hour</div><div class="result-value" id="mf_th">‚Äî<span>t/h</span></div></div>
              <div class="result-item"><div class="result-label">lb/hr</div><div class="result-value" id="mf_lbh">‚Äî<span>lb/h</span></div></div>
            </div>
            <div class="formula-box">·πÅ = œÅ √ó Q &nbsp;|&nbsp; All inputs converted to SI before calculation</div>
          </div>
        </div>
      </div>

      <!-- Reynolds Number -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Reynolds Number</div>
          <div class="card-badge">Re = œÅvD/Œº</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Fluid Velocity (m/s)</label>
            <input type="number" id="re_v" placeholder="2.5" step="any">
          </div>
          <div class="field-group">
            <label>Pipe Internal Diameter (m)</label>
            <input type="number" id="re_d" placeholder="0.1" step="any">
          </div>
          <div class="field-group">
            <label>Fluid Density (kg/m¬≥)</label>
            <input type="number" id="re_rho" placeholder="998" step="any">
          </div>
          <div class="field-group">
            <label>Dynamic Viscosity (Pa¬∑s)</label>
            <input type="number" id="re_mu" placeholder="0.001" step="any">
          </div>
          <button class="calc-btn" onclick="calcReynolds()">CALCULATE Re</button>
          <div class="result-panel" id="re_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">Reynolds Number</div><div class="result-value" id="re_val">‚Äî</div></div>
              <div class="result-item"><div class="result-label">Flow Regime</div><div class="result-value" id="re_regime" style="font-size:1rem">‚Äî</div></div>
            </div>
            <div class="formula-box">Re &lt; 2300 ‚Üí Laminar &nbsp;|&nbsp; 2300‚Äì4000 ‚Üí Transitional &nbsp;|&nbsp; &gt;4000 ‚Üí Turbulent</div>
          </div>
        </div>
      </div>

      <!-- Flow Unit Converter -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Flow Rate Converter</div>
          <div class="card-badge">MULTI-UNIT</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Flow Rate</label>
            <div class="input-row">
              <input type="number" id="fc_val" placeholder="100" step="any">
              <select id="fc_from">
                <option value="m3h">m¬≥/h</option>
                <option value="m3s">m¬≥/s</option>
                <option value="lpm">L/min</option>
                <option value="lps">L/s</option>
                <option value="gpm">GPM</option>
                <option value="gph">GPH</option>
                <option value="bbd">BBL/day</option>
                <option value="cfm">CFM</option>
              </select>
            </div>
          </div>
          <button class="calc-btn" onclick="calcFlowConvert()">CONVERT ALL</button>
          <div class="result-panel" id="fc_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">m¬≥/h</div><div class="result-value" id="fc_m3h">‚Äî</div></div>
              <div class="result-item"><div class="result-label">m¬≥/s</div><div class="result-value" id="fc_m3s">‚Äî</div></div>
              <div class="result-item"><div class="result-label">L/min</div><div class="result-value" id="fc_lpm">‚Äî</div></div>
              <div class="result-item"><div class="result-label">GPM</div><div class="result-value" id="fc_gpm">‚Äî</div></div>
              <div class="result-item"><div class="result-label">BBL/day</div><div class="result-value" id="fc_bbd">‚Äî</div></div>
              <div class="result-item"><div class="result-label">CFM</div><div class="result-value" id="fc_cfm">‚Äî</div></div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="info-strip">
      <strong>NOTE:</strong> DP flow meters require square root extraction. Flow is proportional to ‚àöŒîP ‚Äî not linear. &nbsp;|&nbsp; Water viscosity (20¬∞C) ‚âà 0.001 Pa¬∑s &nbsp;|&nbsp; Crude oil viscosity varies widely: 0.002‚Äì0.1 Pa¬∑s
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TEMPERATURE ‚ïê‚ïê‚ïê -->
  <div id="temperature" class="tab-content">
    <div class="section-header">
      <div>
        <div class="section-title"><span>MODULE 04</span>Temperature</div>
        <div class="section-accent"></div>
      </div>
      <div class="tag">RTD ¬∑ THERMOCOUPLE ¬∑ UNIT CONVERSION ¬∑ RANGING</div>
    </div>

    <div class="calc-grid">

      <!-- Temperature Unit Converter -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Unit Converter</div>
          <div class="card-badge">¬∞C ¬∑ ¬∞F ¬∑ K ¬∑ ¬∞R</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Temperature Value</label>
            <div class="input-row">
              <input type="number" id="tc_val" placeholder="100" step="any">
              <select id="tc_from">
                <option value="C">¬∞C</option>
                <option value="F">¬∞F</option>
                <option value="K">K</option>
                <option value="R">¬∞R</option>
              </select>
            </div>
          </div>
          <button class="calc-btn" onclick="calcTempConvert()">CONVERT ALL</button>
          <div class="result-panel" id="tc_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">Celsius</div><div class="result-value" id="tc_C">‚Äî<span>¬∞C</span></div></div>
              <div class="result-item"><div class="result-label">Fahrenheit</div><div class="result-value" id="tc_F">‚Äî<span>¬∞F</span></div></div>
              <div class="result-item"><div class="result-label">Kelvin</div><div class="result-value" id="tc_K">‚Äî<span>K</span></div></div>
              <div class="result-item"><div class="result-label">Rankine</div><div class="result-value" id="tc_R">‚Äî<span>¬∞R</span></div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- RTD Resistance Calculator -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">RTD Resistance (PT100 / PT1000)</div>
          <div class="card-badge">Callendar‚ÄìVan Dusen</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>RTD Type</label>
            <select id="rtd_type">
              <option value="pt100">PT100 (R‚ÇÄ = 100 Œ©)</option>
              <option value="pt1000">PT1000 (R‚ÇÄ = 1000 Œ©)</option>
            </select>
          </div>
          <div class="field-group">
            <label>Temperature (¬∞C)</label>
            <input type="number" id="rtd_temp" placeholder="25" step="any" min="-200" max="850">
          </div>
          <button class="calc-btn" onclick="calcRTD()">CALCULATE RESISTANCE</button>
          <div class="result-panel" id="rtd_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">Resistance (Œ©)</div><div class="result-value" id="rtd_ohm">‚Äî<span>Œ©</span></div></div>
              <div class="result-item"><div class="result-label">R‚ÇÄ Reference</div><div class="result-value" id="rtd_r0">‚Äî<span>Œ©</span></div></div>
            </div>
            <div class="formula-box">R(T) = R‚ÇÄ[1 + Œ±T + Œ≤T¬≤] &nbsp;|&nbsp; Œ± = 3.9083√ó10‚Åª¬≥ &nbsp;|&nbsp; Œ≤ = ‚àí5.775√ó10‚Åª‚Å∑ (T‚â•0)</div>
          </div>
        </div>
      </div>

      <!-- Thermocouple mV Reference -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Thermocouple Type Reference</div>
          <div class="card-badge">mV LOOKUP</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>Thermocouple Type</label>
            <select id="tc_type">
              <option value="K">Type K (Chromel/Alumel) ‚Äî ‚àí200 to 1260¬∞C</option>
              <option value="J">Type J (Iron/Constantan) ‚Äî ‚àí210 to 750¬∞C</option>
              <option value="T">Type T (Copper/Constantan) ‚Äî ‚àí270 to 400¬∞C</option>
              <option value="E">Type E (Chromel/Constantan) ‚Äî ‚àí270 to 1000¬∞C</option>
              <option value="S">Type S (Pt-10%Rh/Pt) ‚Äî 0 to 1760¬∞C</option>
              <option value="R">Type R (Pt-13%Rh/Pt) ‚Äî 0 to 1760¬∞C</option>
              <option value="N">Type N (Nicrosil/Nisil) ‚Äî ‚àí270 to 1300¬∞C</option>
            </select>
          </div>
          <div class="field-group">
            <label>Temperature (¬∞C)</label>
            <input type="number" id="tc_mv_temp" placeholder="200" step="any">
          </div>
          <button class="calc-btn" onclick="calcTCmV()">GET mV OUTPUT</button>
          <div class="result-panel" id="tc_mv_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">Approx. EMF</div><div class="result-value" id="tc_mv_val">‚Äî<span>mV</span></div></div>
              <div class="result-item"><div class="result-label">Sensitivity</div><div class="result-value" id="tc_mv_sens">‚Äî<span>ŒºV/¬∞C</span></div></div>
            </div>
            <div class="formula-box" id="tc_mv_range"></div>
          </div>
        </div>
      </div>

      <!-- Transmitter Ranging -->
      <div class="calc-card">
        <div class="card-header">
          <div class="card-title">Temperature Transmitter Scaling</div>
          <div class="card-badge">4‚Äì20 mA RANGE</div>
        </div>
        <div class="card-body">
          <div class="field-group">
            <label>LRV Temperature</label>
            <div class="input-row">
              <input type="number" id="tr_lrv" placeholder="0" step="any">
              <select id="tr_unit"><option>¬∞C</option><option>¬∞F</option><option>K</option></select>
            </div>
          </div>
          <div class="field-group">
            <label>URV Temperature</label>
            <input type="number" id="tr_urv" placeholder="200" step="any">
          </div>
          <div class="field-group">
            <label>Measured Temperature (PV)</label>
            <input type="number" id="tr_pv" placeholder="120" step="any">
          </div>
          <button class="calc-btn" onclick="calcTempScaling()">CALCULATE mA OUTPUT</button>
          <div class="result-panel" id="tr_result">
            <div class="result-grid">
              <div class="result-item"><div class="result-label">mA Output</div><div class="result-value" id="tr_ma">‚Äî<span>mA</span></div></div>
              <div class="result-item"><div class="result-label">% of Span</div><div class="result-value" id="tr_pct">‚Äî<span>%</span></div></div>
              <div class="result-item"><div class="result-label">Span</div><div class="result-value" id="tr_span">‚Äî</div></div>
              <div class="result-item"><div class="result-label">mA/¬∞C Sensitivity</div><div class="result-value" id="tr_sens">‚Äî</div></div>
            </div>
            <div class="range-bar-wrap">
              <div class="result-label" style="margin-top:0.75rem;margin-bottom:4px">SIGNAL POSITION</div>
              <div class="range-bar-track"><div class="range-bar-fill" id="tr_bar_fill" style="background:var(--accent4);width:0%"></div></div>
              <div class="range-labels"><span>4 mA (LRV)</span><span>12 mA (50%)</span><span>20 mA (URV)</span></div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="info-strip">
      <strong>REFERENCE:</strong> PT100 at 0¬∞C = 100Œ©, at 100¬∞C ‚âà 138.5Œ© &nbsp;|&nbsp; Type K sensitivity ‚âà 41 ŒºV/¬∞C &nbsp;|&nbsp; Always use cold junction compensation for thermocouples &nbsp;|&nbsp; IEC 60751 standard for RTDs
    </div>
  </div>

</div>

<footer>
  <p>PLANTCALC INSTRUMENTATION SUITE v1.0 &nbsp;|&nbsp; ALL CALCULATIONS FOR REFERENCE ONLY &nbsp;|&nbsp; VERIFY CRITICAL VALUES WITH CALIBRATED INSTRUMENTS</p>
  <p>PWA ENABLED ‚Äî WORKS OFFLINE &nbsp;|&nbsp; PRESSURE ¬∑ LEVEL ¬∑ FLOW ¬∑ TEMPERATURE &nbsp;|&nbsp; SI & IMPERIAL UNITS</p>
</footer>

<!-- Offline indicator -->
<div id="offline-bar">‚ö† NO NETWORK CONNECTION ‚Äî ALL CALCULATORS WORK OFFLINE</div>
<div id="online-flash" style="display:none">‚úî BACK ONLINE</div>

<!-- PWA Install Banner -->
<div id="install-banner">
  <div class="install-title">üì≤ Install PlantCalc</div>
  <div class="install-desc">Add to your home screen for instant access ‚Äî works fully offline in the field. No app store required.</div>
  <div class="install-actions">
    <button class="install-btn primary" onclick="installPWA()">INSTALL</button>
    <button class="install-btn secondary" onclick="dismissInstall()">LATER</button>
  </div>
</div>

<script>
/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PWA SETUP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
let deferredPrompt = null;

// Register service worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js')
      .then(reg => console.log('PlantCalc SW registered:', reg.scope))
      .catch(err => console.log('SW registration failed:', err));
  });
}

// Capture install prompt
window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  deferredPrompt = e;
  // Show install banner after 3 seconds
  setTimeout(() => {
    if (!localStorage.getItem('pwa-dismissed')) {
      document.getElementById('install-banner').classList.add('show');
    }
  }, 3000);
});

function installPWA() {
  if (!deferredPrompt) return;
  deferredPrompt.prompt();
  deferredPrompt.userChoice.then(choice => {
    if (choice.outcome === 'accepted') {
      document.getElementById('install-banner').classList.remove('show');
    }
    deferredPrompt = null;
  });
}

function dismissInstall() {
  document.getElementById('install-banner').classList.remove('show');
  localStorage.setItem('pwa-dismissed', '1');
}

// Handle app installed
window.addEventListener('appinstalled', () => {
  document.getElementById('install-banner').classList.remove('show');
  deferredPrompt = null;
});

// Offline / online detection
window.addEventListener('offline', () => {
  document.getElementById('offline-bar').classList.add('show');
});

window.addEventListener('online', () => {
  document.getElementById('offline-bar').classList.remove('show');
  const flash = document.getElementById('online-flash');
  flash.style.display = 'block';
  setTimeout(() => { flash.style.display = 'none'; }, 2500);
});

// Handle URL hash for shortcuts
window.addEventListener('load', () => {
  const hash = window.location.hash.replace('#','');
  if (['pressure','level','flow','temperature'].includes(hash)) switchTab(hash);
});

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ TAB SWITCHING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
function switchTab(name) {
  document.querySelectorAll('.tab').forEach(t => t.classList.toggle('active', t.dataset.tab === name));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.toggle('active', c.id === name));
}

function showResult(id) {
  const el = document.getElementById(id);
  el.classList.add('show');
}

function fmt(n, dec=2) {
  if (Math.abs(n) >= 1e6) return n.toExponential(3);
  if (Math.abs(n) >= 1000) return n.toFixed(dec > 0 ? 1 : 0);
  return n.toFixed(dec);
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PRESSURE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
function calcHydrostatic() {
  let density = parseFloat(document.getElementById('p_density').value);
  let height  = parseFloat(document.getElementById('p_height').value);
  const du = document.getElementById('p_density_unit').value;
  const hu = document.getElementById('p_height_unit').value;

  if (isNaN(density) || isNaN(height)) return;

  // Convert density to kg/m3
  if (du === 'lbft3') density *= 16.0185;
  if (du === 'sgrav') density *= 998;

  // Convert height to meters
  if (hu === 'ft') height *= 0.3048;
  if (hu === 'in') height *= 0.0254;
  if (hu === 'mm') height *= 0.001;

  const pa  = density * 9.81 * height;
  const bar = pa / 1e5;
  const psi = pa * 0.000145038;
  const kpa = pa / 1000;

  document.getElementById('p_pa').innerHTML  = fmt(pa) + '<span>Pa</span>';
  document.getElementById('p_bar').innerHTML = fmt(bar, 4) + '<span>bar</span>';
  document.getElementById('p_psi').innerHTML = fmt(psi, 4) + '<span>psi</span>';
  document.getElementById('p_kpa').innerHTML = fmt(kpa, 3) + '<span>kPa</span>';
  document.getElementById('p_formula').textContent = `P = ${density.toFixed(1)} √ó 9.81 √ó ${height.toFixed(3)} = ${fmt(pa)} Pa`;
  showResult('p_result');
}

function calcPressureConvert() {
  const val  = parseFloat(document.getElementById('pu_value').value);
  const from = document.getElementById('pu_from').value;
  if (isNaN(val)) return;

  // To Pa
  const toPA = { pa:1, kpa:1000, bar:1e5, mbar:100, psi:6894.76, atm:101325, mmhg:133.322, inwc:249.089, mmwc:9.80638 };
  const pa = val * toPA[from];

  document.getElementById('pu_pa').textContent   = fmt(pa);
  document.getElementById('pu_kpa').textContent  = fmt(pa/1000, 4);
  document.getElementById('pu_bar').textContent  = fmt(pa/1e5, 6);
  document.getElementById('pu_mbar').textContent = fmt(pa/100, 3);
  document.getElementById('pu_psi').textContent  = fmt(pa*0.000145038, 5);
  document.getElementById('pu_atm').textContent  = fmt(pa/101325, 6);
  document.getElementById('pu_mmhg').textContent = fmt(pa/133.322, 3);
  document.getElementById('pu_inwc').textContent = fmt(pa/249.089, 4);
  showResult('pu_result');
}

function calcPressureScaling() {
  const lrv = parseFloat(document.getElementById('p_lrv').value);
  const urv = parseFloat(document.getElementById('p_urv').value);
  const pv  = parseFloat(document.getElementById('p_pv').value);
  if (isNaN(lrv) || isNaN(urv) || isNaN(pv)) return;

  const span = urv - lrv;
  const pct  = ((pv - lrv) / span) * 100;
  const ma   = 4 + (pct / 100) * 16;

  document.getElementById('p_ma').innerHTML    = fmt(ma, 3) + '<span>mA</span>';
  document.getElementById('p_pct').innerHTML   = fmt(pct, 1) + '<span>%</span>';
  document.getElementById('p_span').textContent = fmt(span, 3);
  document.getElementById('p_bar_fill').style.width = Math.min(Math.max(pct, 0), 100) + '%';
  showResult('p_scale_result');
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LEVEL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
function calcDryLeg() {
  const rho = parseFloat(document.getElementById('dl_density').value);
  const H   = parseFloat(document.getElementById('dl_height').value);
  if (isNaN(rho) || isNaN(H)) return;

  const g = 9.81;
  const lrv = 0;
  const urv = rho * g * H;

  document.getElementById('dl_lrv').innerHTML = '0<span>Pa</span>';
  document.getElementById('dl_urv').innerHTML = fmt(urv) + '<span>Pa</span>';
  document.getElementById('dl_lrv_mbar').innerHTML = '0<span>mbar</span>';
  document.getElementById('dl_urv_mbar').innerHTML = fmt(urv/100, 2) + '<span>mbar</span>';
  showResult('dl_result');
}

function calcWetLeg() {
  const rho_p = parseFloat(document.getElementById('wl_proc_density').value);
  const rho_l = parseFloat(document.getElementById('wl_leg_density').value);
  const H     = parseFloat(document.getElementById('wl_height').value);
  const L     = parseFloat(document.getElementById('wl_leg_height').value);
  if (isNaN(rho_p)||isNaN(rho_l)||isNaN(H)||isNaN(L)) return;

  const g   = 9.81;
  const lrv = -(rho_l * g * L);
  const urv = (rho_p * g * H) - (rho_l * g * L);

  document.getElementById('wl_lrv').innerHTML = fmt(lrv) + '<span>Pa</span>';
  document.getElementById('wl_urv').innerHTML = fmt(urv) + '<span>Pa</span>';
  document.getElementById('wl_lrv_mbar').innerHTML = fmt(lrv/100, 2);
  document.getElementById('wl_urv_mbar').innerHTML = fmt(urv/100, 2);
  showResult('wl_result');
}

function calcLevelFromMA() {
  const lrv  = parseFloat(document.getElementById('lv_lrv').value);
  const urv  = parseFloat(document.getElementById('lv_urv').value);
  const ma   = parseFloat(document.getElementById('lv_ma').value);
  const H    = parseFloat(document.getElementById('lv_height').value);
  if (isNaN(lrv)||isNaN(urv)||isNaN(ma)||isNaN(H)) return;

  const span = urv - lrv;
  const pct  = ((ma - 4) / 16) * 100;
  const dp   = lrv + (pct/100) * span;
  const lm   = (pct/100) * H;

  document.getElementById('lv_pct').innerHTML = fmt(pct, 1) + '<span>%</span>';
  document.getElementById('lv_m').innerHTML   = fmt(lm, 3) + '<span>m</span>';
  document.getElementById('lv_dp').innerHTML  = fmt(dp, 1) + '<span>Pa</span>';
  document.getElementById('lv_span').textContent = fmt(span);
  document.getElementById('lv_bar_fill').style.width = Math.min(Math.max(pct, 0), 100) + '%';
  showResult('lv_result');
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ FLOW ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
function calcDPFlow() {
  const dp_max = parseFloat(document.getElementById('fp_dp_max').value);
  const qmax   = parseFloat(document.getElementById('fp_qmax').value);
  const dp_act = parseFloat(document.getElementById('fp_dp_actual').value);
  const unit   = document.getElementById('fp_qunit').value;
  if (isNaN(dp_max)||isNaN(qmax)||isNaN(dp_act)) return;

  const q_act = qmax * Math.sqrt(dp_act / dp_max);
  const pct   = (q_act / qmax) * 100;
  const uLabels = { m3h:'m¬≥/h', lpm:'L/min', gpm:'GPM', bbd:'BBL/d' };

  document.getElementById('fp_q').innerHTML   = fmt(q_act, 2) + '<span>' + uLabels[unit] + '</span>';
  document.getElementById('fp_pct').innerHTML = fmt(pct, 1) + '<span>%</span>';
  showResult('fp_result');
}

function calcMassFlow() {
  let vol = parseFloat(document.getElementById('mf_vol').value);
  const rho  = parseFloat(document.getElementById('mf_density').value);
  const unit = document.getElementById('mf_vunit').value;
  if (isNaN(vol)||isNaN(rho)) return;

  // to m3/s
  if (unit === 'm3h') vol /= 3600;
  if (unit === 'lpm') vol /= 60000;
  if (unit === 'gpm') vol *= 6.30902e-5;

  const kgs = rho * vol;
  const kgh = kgs * 3600;
  const th  = kgh / 1000;
  const lbh = kgh * 2.20462;

  document.getElementById('mf_kgh').innerHTML = fmt(kgh, 2) + '<span>kg/h</span>';
  document.getElementById('mf_kgs').innerHTML = fmt(kgs, 4) + '<span>kg/s</span>';
  document.getElementById('mf_th').innerHTML  = fmt(th, 4) + '<span>t/h</span>';
  document.getElementById('mf_lbh').innerHTML = fmt(lbh, 2) + '<span>lb/h</span>';
  showResult('mf_result');
}

function calcReynolds() {
  const v   = parseFloat(document.getElementById('re_v').value);
  const D   = parseFloat(document.getElementById('re_d').value);
  const rho = parseFloat(document.getElementById('re_rho').value);
  const mu  = parseFloat(document.getElementById('re_mu').value);
  if (isNaN(v)||isNaN(D)||isNaN(rho)||isNaN(mu)) return;

  const Re = (rho * v * D) / mu;
  let regime = Re < 2300 ? 'LAMINAR' : Re < 4000 ? 'TRANSITIONAL' : 'TURBULENT';

  document.getElementById('re_val').textContent    = fmt(Re, 0);
  document.getElementById('re_regime').textContent = regime;
  showResult('re_result');
}

function calcFlowConvert() {
  let val  = parseFloat(document.getElementById('fc_val').value);
  const fr = document.getElementById('fc_from').value;
  if (isNaN(val)) return;

  // to m3/s
  const toM3S = { m3h:1/3600, m3s:1, lpm:1/60000, lps:0.001, gpm:6.30902e-5, gph:6.30902e-5/60, bbd:1.84013e-5, cfm:4.71947e-4 };
  const m3s = val * toM3S[fr];

  document.getElementById('fc_m3h').textContent = fmt(m3s * 3600, 4);
  document.getElementById('fc_m3s').textContent = fmt(m3s, 6);
  document.getElementById('fc_lpm').textContent = fmt(m3s * 60000, 3);
  document.getElementById('fc_gpm').textContent = fmt(m3s / 6.30902e-5, 3);
  document.getElementById('fc_bbd').textContent = fmt(m3s / 1.84013e-5, 2);
  document.getElementById('fc_cfm').textContent = fmt(m3s / 4.71947e-4, 3);
  showResult('fc_result');
}

/* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ TEMPERATURE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
function toC(val, from) {
  if (from === 'C') return val;
  if (from === 'F') return (val - 32) * 5/9;
  if (from === 'K') return val - 273.15;
  if (from === 'R') return (val - 491.67) * 5/9;
}

function calcTempConvert() {
  const val  = parseFloat(document.getElementById('tc_val').value);
  const from = document.getElementById('tc_from').value;
  if (isNaN(val)) return;

  const C = toC(val, from);
  const F = C * 9/5 + 32;
  const K = C + 273.15;
  const R = (C + 273.15) * 9/5;

  document.getElementById('tc_C').innerHTML = fmt(C, 2) + '<span>¬∞C</span>';
  document.getElementById('tc_F').innerHTML = fmt(F, 2) + '<span>¬∞F</span>';
  document.getElementById('tc_K').innerHTML = fmt(K, 2) + '<span>K</span>';
  document.getElementById('tc_R').innerHTML = fmt(R, 2) + '<span>¬∞R</span>';
  showResult('tc_result');
}

function calcRTD() {
  const T    = parseFloat(document.getElementById('rtd_temp').value);
  const type = document.getElementById('rtd_type').value;
  const R0   = type === 'pt100' ? 100 : 1000;
  if (isNaN(T)) return;

  // IEC 60751 Callendar-Van Dusen
  const A =  3.9083e-3;
  const B = -5.775e-7;
  const C_coef = -4.183e-12;
  let R;
  if (T >= 0) {
    R = R0 * (1 + A*T + B*T*T);
  } else {
    R = R0 * (1 + A*T + B*T*T + C_coef*(T-100)*T*T*T);
  }

  document.getElementById('rtd_ohm').innerHTML = fmt(R, 3) + '<span>Œ©</span>';
  document.getElementById('rtd_r0').innerHTML  = R0 + '<span>Œ©</span>';
  showResult('rtd_result');
}

// Thermocouple approximate sensitivity (ŒºV/¬∞C) and range
const TC_DATA = {
  K: { sens: 41,  range: '-200 to 1260¬∞C', color: 'var(--accent4)' },
  J: { sens: 52,  range: '-210 to 750¬∞C',  color: 'var(--accent3)' },
  T: { sens: 43,  range: '-270 to 400¬∞C',  color: 'var(--accent2)' },
  E: { sens: 68,  range: '-270 to 1000¬∞C', color: 'var(--accent)'  },
  S: { sens: 10,  range: '0 to 1760¬∞C',    color: 'var(--text)'    },
  R: { sens: 10,  range: '0 to 1760¬∞C',    color: 'var(--text)'    },
  N: { sens: 39,  range: '-270 to 1300¬∞C', color: 'var(--accent3)' },
};

function calcTCmV() {
  const T    = parseFloat(document.getElementById('tc_mv_temp').value);
  const type = document.getElementById('tc_type').value;
  const d    = TC_DATA[type];
  if (isNaN(T)) return;

  // Approximate mV using sensitivity (good for linear estimate)
  const mv = (d.sens * T) / 1000;

  document.getElementById('tc_mv_val').innerHTML  = fmt(mv, 3) + '<span>mV</span>';
  document.getElementById('tc_mv_sens').innerHTML = d.sens + '<span>ŒºV/¬∞C</span>';
  document.getElementById('tc_mv_range').textContent = `Type ${type} | Range: ${d.range} | Approximate linear estimate only ‚Äî use NIST tables for precision`;
  showResult('tc_mv_result');
}

function calcTempScaling() {
  const lrv = parseFloat(document.getElementById('tr_lrv').value);
  const urv = parseFloat(document.getElementById('tr_urv').value);
  const pv  = parseFloat(document.getElementById('tr_pv').value);
  if (isNaN(lrv)||isNaN(urv)||isNaN(pv)) return;

  const span = urv - lrv;
  const pct  = ((pv - lrv) / span) * 100;
  const ma   = 4 + (pct/100) * 16;
  const sens = 16 / span;

  document.getElementById('tr_ma').innerHTML   = fmt(ma, 3) + '<span>mA</span>';
  document.getElementById('tr_pct').innerHTML  = fmt(pct, 1) + '<span>%</span>';
  document.getElementById('tr_span').textContent = fmt(span) + ' ¬∞';
  document.getElementById('tr_sens').textContent = fmt(sens, 4) + ' mA/¬∞';
  document.getElementById('tr_bar_fill').style.width = Math.min(Math.max(pct, 0), 100) + '%';
  showResult('tr_result');
}
</script>
</body>
</html>
